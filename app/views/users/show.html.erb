<% if flash[:notice] %>
 <p id="notice">
<%= flash[:notice] %>
 </p>
<% end %>

<div class="container">
 <div class="row">
  <div class="col-md-3">
   <div class="sidebar_content">
    <div>
     <h1>User info</h1>
     <%= render 'users/user', user: @user %>
    </div>
    <div>
     <h1>New book</h1>
     <%= render 'books/book', book: @book %>
    </div>
   </div>
  </div>

  <div class = "col-md-8 offset-md-1">
    <h1>Books</h1>
    <table class="table table-striped">
     <thead>
      <tr>
        <th></th>
        <th>Title</th>
        <th>Opinion</th>
        <th colspan="2">
       
      </tr>
     </thead>
     <tbody>
       <tr>
      <% @books.each do |book| %>
        <td>
         <%= link_to user_path(book.user) do %>
          <%= attachment_image_tag book.user, :profile_image, :fill, 100, 100, format: 'jpeg', fallback: "no_image.jpg" %>
         <% end %>
        </td>
        <td><%= link_to book.title, book_path(book.id) %></td>
        <td><%= book.body %></td>
        <td>
         <% if book.favorited_by?(current_user) %>
           <%= link_to book_favorites_path(book.id), method: :delete do %>
           <i class="fas fa-heart unlike-btn"></i>
           <%= book.favorites.count %>
           <% end %>
         <% else %>
           <%= link_to book_favorites_path(book.id), method: :post do %>
           <i class="far fa-heart like-btn"></i>
           <%= book.favorites.count %>
           <% end %>
         <% end %>
        </td>
        <td><p>コメント数：<%= book.book_comments.count %></p></td>
       </tr>
      <% end %>
     </tbody>
    </table>
  </div>
 </div>
</div>